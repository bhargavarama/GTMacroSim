(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     94603,       2005]
NotebookOptionsPosition[     93658,       1973]
NotebookOutlinePosition[     94001,       1988]
CellTagsIndexPosition[     93958,       1985]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"root", " ", "=", " ", "\"\<c:/data/TimeInvariant/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Kj", "=", "150."}], ";", 
  RowBox[{"w", "=", "20."}], ";", 
  RowBox[{"Vf", "=", "100."}], ";", 
  RowBox[{"cap", "=", "2500."}], ";", 
  RowBox[{"L", "=", "1."}], ";", 
  RowBox[{"b", "=", "0.1"}], ";", 
  RowBox[{"dx", "=", 
   RowBox[{"1.", "/", "9"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"demF", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"Max", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"p1", " ", "Vf"}], ",", 
          RowBox[{"L", " ", "cap"}]}], "]"}], "-", "p2"}]}], "]"}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"demR", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], "}"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"p1", " ", "Vf"}], ",", "cap"}], "]"}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"supF", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], "}"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"L", " ", "Kj"}], "-", "p1"}], ")"}], " ", "w"}], ",", 
       RowBox[{"L", " ", "cap"}]}], "]"}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NsupF", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p3", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p4", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"Max", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"L", " ", "Kj"}], "-", "p1"}], ")"}], " ", "Vf"}], "-", 
           "p2", "-", "p3"}], ",", 
          RowBox[{"L", " ", "cap"}]}], "]"}], "-", "p4"}]}], "]"}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NsupR", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Kj", "-", "p1"}], ")"}], " ", "Vf"}], "-", "p2"}], ",", 
       "cap"}], "]"}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"floF", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p3", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p4", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p5", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"demF", "[", 
        RowBox[{"p1", ",", "p5"}], "]"}], ",", 
       RowBox[{"NsupF", "[", 
        RowBox[{"p2", ",", "p3", ",", "p4", ",", "p5"}], "]"}]}], "]"}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"floR", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p3", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"demR", "[", "p1", "]"}], ",", 
       RowBox[{"NsupR", "[", 
        RowBox[{"p2", ",", "p3"}], "]"}]}], "]"}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"floR1", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p3", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"demR", "[", "#1", "]"}], ",", 
          RowBox[{"NsupR", "[", 
           RowBox[{"#2", ",", "#3"}], "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Most", "/@", "p1"}], ",", 
         RowBox[{"Rest", "/@", "p2"}], ",", 
         RowBox[{"Most", "/@", "p3"}]}], "}"}], ",", "2"}], "]"}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamma", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"supF", "[", "p2", "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"demF", "[", 
           RowBox[{"p1", ",", "0"}], "]"}], "+", "0.001"}], ")"}]}]}], "]"}], 
     ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"den", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p3", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p1", "-", "p2", "+", "p3"}], ")"}], "/", "Vf"}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
       "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"inflow", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p1", "-", 
        RowBox[{"b", " ", "p2"}]}], ")"}], " ", "dx"}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
       "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"updateF", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p2", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"L", " ", "Kj"}], ",", 
        RowBox[{"p1", "+", "p2"}]}], "]"}], ",", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
        "}"}]}]}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"updateR", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"p1", "+", "p2"}], ",", 
       RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
       RowBox[{"RuntimeAttributes", "\[Rule]", 
        RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";", "\n", 
    RowBox[{"flowR", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"p", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
       RowBox[{"RuntimeAttributes", "\[Rule]", 
        RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"CompilePrint", "[", "flowR", "]"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"compiledMin", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{"p1", ",", "p2"}], "]"}], ",", 
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.612023226274868*^9, 3.612023308894287*^9}, {
   3.6120289429476037`*^9, 3.6120289539439216`*^9}, {3.612101981630884*^9, 
   3.612101985198258*^9}, {3.6121025294596176`*^9, 3.6121025323335314`*^9}, {
   3.612102691318324*^9, 3.612102757763501*^9}, {3.612102791329834*^9, 
   3.6121027983044767`*^9}, {3.6121028404124985`*^9, 3.61210286945282*^9}, {
   3.612102932444417*^9, 3.6121029930439796`*^9}, {3.6121034045060186`*^9, 
   3.6121034051274333`*^9}, 3.6121034432928295`*^9, {3.6121040749284916`*^9, 
   3.612104081288724*^9}, {3.6121042874909377`*^9, 3.6121043152434034`*^9}, 
   3.612104348956001*^9, {3.6121044008935633`*^9, 3.6121044106970897`*^9}, {
   3.6121045975849314`*^9, 3.612104628338397*^9}, {3.612104758575061*^9, 
   3.6121047834015822`*^9}, 3.612105008574419*^9, {3.612107413218937*^9, 
   3.6121074173316717`*^9}, {3.612117740528376*^9, 3.612117764633855*^9}, {
   3.61211795143198*^9, 3.612117963809216*^9}, {3.6121352013952565`*^9, 
   3.61213524918606*^9}, {3.6121352912550526`*^9, 3.6121353157598896`*^9}, 
   3.612135382307171*^9, {3.6121354410803804`*^9, 3.612135445719468*^9}, 
   3.6121359386107426`*^9, {3.6121362237563663`*^9, 3.6121362344324684`*^9}, {
   3.612136283289982*^9, 3.6121362842276077`*^9}, 3.6121363797928495`*^9, {
   3.6121364357718835`*^9, 3.612136441037386*^9}, {3.612136481830531*^9, 
   3.6121365009402485`*^9}, {3.612136621901739*^9, 3.6121366224491034`*^9}, 
   3.6121366821956425`*^9, 3.6121367935613904`*^9, 3.6121374551211495`*^9, {
   3.6121377361291466`*^9, 3.6121377566678143`*^9}, 3.6121378273888736`*^9, {
   3.612137890026557*^9, 3.6121378995458922`*^9}, {3.612138006934985*^9, 
   3.612138013689479*^9}, {3.6121380689132285`*^9, 3.612138072642709*^9}, {
   3.6121381029598846`*^9, 3.612138138015211*^9}, {3.6121381791966143`*^9, 
   3.6121382000524926`*^9}, 3.612138621872572*^9, 3.612139285687533*^9, {
   3.612139829954717*^9, 3.6121398306922083`*^9}, {3.6121400019191484`*^9, 
   3.612140002896799*^9}, {3.6121403567162437`*^9, 3.6121403589967613`*^9}, {
   3.6121409501006794`*^9, 3.612140971555807*^9}, {3.612141154598349*^9, 
   3.612141157954582*^9}, {3.6121427848922844`*^9, 3.612142815617729*^9}, {
   3.612142852346074*^9, 3.6121428531345987`*^9}, {3.6121429346179204`*^9, 
   3.6121430217879267`*^9}, {3.6121434206455793`*^9, 
   3.6121435428314466`*^9}, {3.61214378929737*^9, 3.612143844818313*^9}, {
   3.6121438912922425`*^9, 3.6121439017041674`*^9}, {3.6121439588341837`*^9, 
   3.6121439631550584`*^9}, {3.6121440113821526`*^9, 3.612144035573745*^9}, {
   3.612144121678812*^9, 3.61214414550871*^9}, {3.6121442110293083`*^9, 
   3.612144211846854*^9}, {3.6121442642887526`*^9, 3.6121442651493225`*^9}, {
   3.6121445699298344`*^9, 3.6121446122790127`*^9}, {3.61214470073869*^9, 
   3.612144707414133*^9}, {3.612147894199198*^9, 3.6121479539549613`*^9}, {
   3.612147994780312*^9, 3.612148002762624*^9}, {3.612148050310264*^9, 
   3.6121480513889823`*^9}, {3.612148109704789*^9, 3.6121481107864113`*^9}, {
   3.612152927999116*^9, 3.6121530898108883`*^9}, {3.6121531215540104`*^9, 
   3.6121531583254795`*^9}, 3.6121532031142845`*^9, {3.612153380795519*^9, 
   3.6121533898235292`*^9}, 3.61215343493047*^9, {3.6121551494603176`*^9, 
   3.6121551910248127`*^9}, {3.6121552247764397`*^9, 3.612155254746627*^9}, {
   3.6121555589018607`*^9, 3.6121555661990824`*^9}, {3.612155604857193*^9, 
   3.612155640608906*^9}, {3.612155673110471*^9, 3.612155677313798*^9}, {
   3.612155762218522*^9, 3.612155827924796*^9}, 3.612156201793826*^9, {
   3.612156623817785*^9, 3.6121566491335793`*^9}, {3.6121567718212786`*^9, 
   3.612156798325864*^9}, {3.612167700162096*^9, 3.6121677150189514`*^9}, 
   3.6121681342340517`*^9, 3.612170087589526*^9, {3.612170118192828*^9, 
   3.6121701227888784`*^9}, {3.612170202886012*^9, 3.612170217228527*^9}, {
   3.612170296098846*^9, 3.612170299469082*^9}, {3.612174859074157*^9, 
   3.612174868442374*^9}, {3.612174905478945*^9, 3.6121749141927223`*^9}, {
   3.6121750252794156`*^9, 3.612175049639578*^9}, {3.612175150496484*^9, 
   3.612175173207551*^9}, {3.6121752118951516`*^9, 3.612175223370763*^9}, {
   3.612175448705247*^9, 3.6121754490604815`*^9}, {3.612175480498337*^9, 
   3.6121757635180874`*^9}, {3.612175798662401*^9, 3.612175844638901*^9}, {
   3.6121758778239155`*^9, 3.61217602008529*^9}, {3.6121760528420196`*^9, 
   3.61217606138969*^9}, 3.6121771021585574`*^9, {3.612177193988475*^9, 
   3.612177221599792*^9}, {3.6121772758577876`*^9, 3.6121773079150524`*^9}, {
   3.6121773463505497`*^9, 3.6121773723628087`*^9}, {3.612177508486109*^9, 
   3.6121775182886114`*^9}, {3.6121777079724445`*^9, 
   3.6121777098366814`*^9}, {3.61217780819393*^9, 3.612177814319993*^9}, {
   3.6121778619678545`*^9, 3.61217788217126*^9}, {3.612177951333141*^9, 
   3.6121779608964834`*^9}, 3.612178139420913*^9, {3.6121865737842283`*^9, 
   3.612186577882946*^9}, 3.6121866430231586`*^9, 3.612186820490893*^9, {
   3.6121869451756015`*^9, 3.6121869494764566`*^9}, {3.6121920487112513`*^9, 
   3.6121921851107354`*^9}, {3.6121923389197707`*^9, 3.612192410475238*^9}, {
   3.6121932949433537`*^9, 3.6121933043555984`*^9}, {3.613145258627679*^9, 
   3.6131452651820555`*^9}, 3.613146451343665*^9, {3.6131464911512527`*^9, 
   3.613146516216993*^9}, {3.613146731736936*^9, 3.613146847413198*^9}, {
   3.613146890561015*^9, 3.613146973561451*^9}, {3.6131472630762844`*^9, 
   3.613147305986948*^9}, {3.613147357534374*^9, 3.613147369661475*^9}, {
   3.613147414858659*^9, 3.613147496568232*^9}, {3.6131484150791817`*^9, 
   3.613148445930789*^9}, {3.6131494482339144`*^9, 3.6131495861350193`*^9}, {
   3.6131496255013103`*^9, 3.6131496511274304`*^9}, 3.613149993584152*^9, 
   3.6131500598748837`*^9, 3.6131501808636923`*^9, {3.6131502438747816`*^9, 
   3.613150251775058*^9}, {3.613150297673713*^9, 3.6131502991647053`*^9}, {
   3.613150346839552*^9, 3.6131504004687157`*^9}, {3.6131504313623486`*^9, 
   3.6131504314223986`*^9}, {3.6131504788900948`*^9, 3.613150498697141*^9}, {
   3.613151008580276*^9, 3.6131510658785458`*^9}, {3.613152051202121*^9, 
   3.613152079791216*^9}, {3.6131521286228323`*^9, 3.6131521486121836`*^9}, {
   3.613152192873742*^9, 3.6131522379038167`*^9}, {3.613152269873169*^9, 
   3.6131523256063943`*^9}, {3.61315241262111*^9, 3.6131524501031456`*^9}, {
   3.6131529879080944`*^9, 3.6131530084007792`*^9}, {3.6131530787757826`*^9, 
   3.6131531052364006`*^9}, {3.613153173983316*^9, 3.613153198144453*^9}, 
   3.613153249675871*^9, {3.6131533091871786`*^9, 3.6131533240070753`*^9}, {
   3.6131533540361333`*^9, 3.6131534326856627`*^9}, {3.613153636490615*^9, 
   3.613153648579687*^9}, {3.6131692502722907`*^9, 3.61316925126896*^9}, 
   3.613169302896442*^9, {3.613169342831111*^9, 3.613169349593627*^9}, {
   3.6131726111332846`*^9, 3.613172632892819*^9}, {3.613177713513173*^9, 
   3.6131777157706814`*^9}, {3.613178217242371*^9, 3.613178221337104*^9}, {
   3.613203069935812*^9, 3.6132031010025606`*^9}, {3.6132160416467896`*^9, 
   3.613216042378278*^9}, {3.6132174489653153`*^9, 3.6132174511827955`*^9}, {
   3.6132266688739643`*^9, 3.6132268623871007`*^9}, {3.613227323304158*^9, 
   3.613227340585599*^9}, {3.613227661517871*^9, 3.613227724158346*^9}, {
   3.613227817559194*^9, 3.6132278176292405`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "10"}], ";", 
  RowBox[{"p", "=", "5"}], ";", 
  RowBox[{"RML", "=", "3"}], ";", 
  RowBox[{"delta", "=", "1."}], ";", 
  RowBox[{"dt", "=", 
   RowBox[{"4.", "/", "3600."}]}], ";", 
  RowBox[{"Ssteps", "=", "10."}], ";", 
  RowBox[{"a", "=", "10"}], ";", 
  RowBox[{"Shutoff", "=", "False"}], ";", 
  RowBox[{"j", "=", "1."}], ";", 
  RowBox[{"Tsteps", "=", 
   RowBox[{
    RowBox[{"Length", "[", "aa", "]"}], "/", "Ssteps"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<k0:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "30", "]"}], ",", 
     RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Fk:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fk", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "30", "]"}], ",", 
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<kr:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kr", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "50", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", "-", "2"}], "}"}], ",", 
     RowBox[{"{", "p", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<qr:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qr", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "1000", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", "-", "2"}], "}"}], ",", 
     RowBox[{"{", "p", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Rk:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rk", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "150", "]"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", "-", "2"}], "}"}], ",", 
     RowBox[{"{", "p", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Fq:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "1500", "]"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", "-", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Fin:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fin", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "1000", "]"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", "-", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Rq:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "1000", "]"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", "-", "2"}], "}"}], ",", 
     RowBox[{"{", "p", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"10", " ", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "20"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RM", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"aa", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"j", "-", "1"}], ")"}], "*", "Ssteps"}], "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Floor", "[", 
             RowBox[{"i", " ", "dx"}], "]"}], "<", "1"}], ",", " ", "1", ",", 
           RowBox[{"Ceiling", "[", 
            RowBox[{"i", " ", "dx"}], "]"}]}], "]"}]}], "]"}], "]"}], " ", 
      "100"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "Tsteps"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RMori", "=", 
   RowBox[{"RM", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fi", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"demR", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "&"}], "/@", "kr"}], " ", 
     RowBox[{"gamma", "[", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{"k0", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Take", "[", 
        RowBox[{"k0", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"qf", "=", 
     RowBox[{"floF", "[", 
      RowBox[{
       RowBox[{"Most", "@", "k0"}], ",", 
       RowBox[{"Rest", "@", 
        RowBox[{"(", 
         RowBox[{"Fk", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ")"}]}], ",", 
       RowBox[{"Total", "@", "Fq"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Total", "@", "Fin"}], ",", 
         RowBox[{"{", "0.", "}"}]}], "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"fi", " ", "dx"}], ",", 
         RowBox[{"{", "0.", "}"}]}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"qin", "=", 
     RowBox[{"inflow", "[", 
      RowBox[{"fi", ",", 
       RowBox[{"Most", "@", "qf"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"k0", "=", 
     RowBox[{"updateF", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "0.", "}"}], ",", 
         RowBox[{"den", "[", 
          RowBox[{
           RowBox[{"Most", "@", "qf"}], ",", 
           RowBox[{"Rest", "@", "qf"}], ",", "qin"}], "]"}], ",", 
         RowBox[{"{", "0.", "}"}]}], "]"}], ",", "k0"}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<qsum:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qsum", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "6000", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", "-", "2"}], "}"}], ",", 
     RowBox[{"{", "p", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<Check:\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"kr", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", "10"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"RML", "-", "1"}]}], "}"}]}], "]"}], "&"}], "/@", 
          "kr"}], "\[IndentingNewLine]", 
         RowBox[{"Take", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "RML"}], "}"}]}], "]"}]}], "&"}], "/@", 
       RowBox[{"Rk", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
      RowBox[{"Take", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"RML", "-", "1"}]}], "}"}]}], "]"}]}], "&"}], "/@", 
    "qsum"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"floR", "[", 
       RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Most", "/@", "kr"}], ",", 
       RowBox[{"Rest", "/@", 
        RowBox[{"Rk", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"Most", "/@", "qsum"}]}], "}"}], ",", "2"}], "]"}], 
   "\[IndentingNewLine]", "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"floR", "[", 
       RowBox[{
        RowBox[{"Most", "/@", "kr"}], ",", 
        RowBox[{"Rest", "/@", 
         RowBox[{"Rk", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"Most", "/@", "qsum"}]}], "]"}], ",", 
      RowBox[{"List", " ", "/@", "fi"}], ",", "2"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"t", "=", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"floR", "[", 
          RowBox[{
           RowBox[{"Most", "/@", "kr"}], ",", 
           RowBox[{"Rest", "/@", 
            RowBox[{"Rk", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"Most", "/@", "qsum"}]}], "]"}], ",", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", "fi", "}"}]}]}], "}"}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t", "\[IndentingNewLine]", "fi", "\[IndentingNewLine]", 
      RowBox[{"t", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "=", "fi"}], ";", 
    "\[IndentingNewLine]", "t"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"qr1", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"floR", "[", 
        RowBox[{
         RowBox[{"Most", "/@", "kr"}], ",", 
         RowBox[{"Rest", "/@", 
          RowBox[{"Rk", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"Most", "/@", "qsum"}]}], "]"}], ",", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", "fi", "}"}]}]}], "}"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "qr1", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qr1", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "RML"}], "]"}], "]"}], "=", 
   RowBox[{"compiledMin", "[", 
    RowBox[{"RMori", ",", 
     RowBox[{"floR", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"kr", "\[Transpose]"}], "[", 
        RowBox[{"[", "RML", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Rk", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"RML", "+", "1"}]}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"qsum", "\[Transpose]"}], "[", 
        RowBox[{"[", "RML", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qr", "=", "qr1"}], 
  ";"}], "\[IndentingNewLine]", "qr", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{"floR", "[", 
       RowBox[{"kr", ",", 
        RowBox[{"Rk", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "qsum"}], "]"}], ",", "2"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"floR", "[", 
        RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"RML", "-", "1"}]}], "}"}]}], "]"}], "&"}], "/@", 
         "kr"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "RML"}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Rk", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"RML", "-", "1"}]}], "}"}]}], "]"}], "&"}], "/@", 
         "qsum"}]}], "}"}], ",", "2"}], "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.613174105465031*^9, {3.6131741355311117`*^9, 3.6131741752606506`*^9}, {
   3.613174276112007*^9, 3.6131746442258725`*^9}, {3.6131762004921412`*^9, 
   3.6131762453669515`*^9}, {3.613176305082836*^9, 3.613176312600857*^9}, {
   3.613176381970187*^9, 3.6131763868914757`*^9}, {3.61317644401763*^9, 
   3.6131765377682414`*^9}, {3.613201835331476*^9, 3.6132018785853643`*^9}, {
   3.613201938984701*^9, 3.6132019734427166`*^9}, {3.6132020523254013`*^9, 
   3.613202139405566*^9}, {3.613202210165827*^9, 3.6132022678572793`*^9}, 
   3.6132025922894144`*^9, 3.6132026423568535`*^9, 3.6132027391731696`*^9, 
   3.613202794180914*^9, {3.613203208785549*^9, 3.6132032126211147`*^9}, 
   3.6132040387364926`*^9, {3.6132041280151224`*^9, 3.6132041928325515`*^9}, {
   3.6132042253872957`*^9, 3.61320427560384*^9}, 3.6132043335415316`*^9, {
   3.613210861450637*^9, 3.613210892411201*^9}, 3.613211025892354*^9, {
   3.6132114741567492`*^9, 3.613211573675702*^9}, {3.6132117563083167`*^9, 
   3.613211846365779*^9}, 3.613212245321707*^9, 3.613212357197427*^9, {
   3.613212412391288*^9, 3.6132124290338078`*^9}, {3.6132124665238466`*^9, 
   3.6132124885875854`*^9}, {3.613213489227378*^9, 3.6132135009832315`*^9}, {
   3.613213552760812*^9, 3.613213588053383*^9}, {3.613213662670028*^9, 
   3.613213667623337*^9}, {3.6132137440343733`*^9, 3.6132138069684067`*^9}, 
   3.6132138446353884`*^9, {3.6132138984166293`*^9, 3.6132139014006133`*^9}, {
   3.6132149976615047`*^9, 3.6132150355398164`*^9}, {3.613215386504223*^9, 
   3.613215387529911*^9}, {3.61321595344488*^9, 3.613216014142423*^9}, {
   3.613216058354953*^9, 3.6132160782342253`*^9}, {3.613216139058855*^9, 
   3.613216164133602*^9}, {3.613216258330512*^9, 3.613216265722453*^9}, {
   3.613216831075046*^9, 3.6132168336857944`*^9}, {3.6132169427916627`*^9, 
   3.6132169430378265`*^9}, {3.613216981023195*^9, 3.6132170929229326`*^9}, {
   3.6132172879301777`*^9, 3.6132172942123747`*^9}, {3.6132173541019564`*^9, 
   3.613217358601961*^9}, {3.6132173920973387`*^9, 3.613217411253132*^9}, {
   3.613220098240243*^9, 3.613220126363859*^9}, {3.613220182249866*^9, 
   3.6132202734912806`*^9}, {3.6132203105708327`*^9, 3.613220327099777*^9}, 
   3.6132207002178397`*^9, {3.613220735917482*^9, 3.613220736344761*^9}, {
   3.6132207860086465`*^9, 3.613220819103565*^9}, {3.613221530100354*^9, 
   3.6132215475979366`*^9}, {3.6132216320608635`*^9, 3.613221637017144*^9}, 
   3.613221769396804*^9, {3.613221807142796*^9, 3.613221832238415*^9}, {
   3.613225613559186*^9, 3.613225663751424*^9}, {3.6132257697275963`*^9, 
   3.6132257995403366`*^9}, {3.613225849822626*^9, 3.6132258737154474`*^9}, {
   3.613225968643305*^9, 3.613225983436104*^9}, {3.6132261380504827`*^9, 
   3.6132261518356056`*^9}, {3.613226292042445*^9, 3.613226316789835*^9}, {
   3.6132263481646066`*^9, 3.613226412459183*^9}, {3.6132264746823807`*^9, 
   3.613226477024931*^9}, {3.613226524345269*^9, 3.613226545462247*^9}, {
   3.6132273564400983`*^9, 3.613227390437609*^9}, {3.6132274793022137`*^9, 
   3.6132274888485394`*^9}, {3.613237459184472*^9, 3.61323746006105*^9}, {
   3.613237493666301*^9, 3.6132375000965586`*^9}, {3.6132385636782513`*^9, 
   3.613238568532465*^9}, {3.6132386682875175`*^9, 3.613238723734233*^9}, {
   3.6132391482413254`*^9, 3.6132391828622465`*^9}, {3.613239905844513*^9, 
   3.6132399161393285`*^9}, {3.6132399845025997`*^9, 
   3.6132399976432967`*^9}, {3.6132400309253345`*^9, 
   3.6132400339613457`*^9}, {3.6132401883025417`*^9, 3.61324018903403*^9}, {
   3.613240286236392*^9, 3.61324030032472*^9}, {3.613240353762104*^9, 
   3.6132403603514643`*^9}, {3.6132406494328165`*^9, 3.613240654476158*^9}, {
   3.6132407573282647`*^9, 3.6132407594706783`*^9}, {3.6132408569262133`*^9, 
   3.6132408576526937`*^9}, {3.613251817035056*^9, 3.613251841514265*^9}, {
   3.613252064021603*^9, 3.6132520806746244`*^9}, {3.6132521372751045`*^9, 
   3.6132521579007607`*^9}, {3.613253749999817*^9, 3.613253756443082*^9}, {
   3.613253944563645*^9, 3.6132539574932103`*^9}, {3.6132570926054735`*^9, 
   3.613257094414672*^9}, {3.613258587011829*^9, 3.613258599982417*^9}, {
   3.613258991225218*^9, 3.6132590647098713`*^9}, {3.613259110400126*^9, 
   3.613259128764286*^9}, {3.6132596703547535`*^9, 3.613259684043822*^9}, {
   3.6132597625369363`*^9, 3.6132597670329137`*^9}, {3.6132598616715784`*^9, 
   3.613259864650546*^9}, {3.613259924151411*^9, 3.613259937616327*^9}, 
   3.6132600800604467`*^9, {3.613263415247224*^9, 3.6132634759404182`*^9}, {
   3.613263506152419*^9, 3.6132635648352766`*^9}, {3.6132636579209175`*^9, 
   3.6132636938356924`*^9}, {3.6132637303758926`*^9, 
   3.6132637762472625`*^9}, {3.6132639336094604`*^9, 3.613264055769349*^9}, {
   3.6132660123887215`*^9, 3.6132660175111146`*^9}, {3.6132690007248726`*^9, 
   3.6132690176220565`*^9}, {3.6132691452824697`*^9, 3.613269148987926*^9}, {
   3.6132691826541243`*^9, 3.6132692154818544`*^9}, 3.6132692718872037`*^9, {
   3.6132700816331234`*^9, 3.61327014197408*^9}, {3.6132701869188395`*^9, 
   3.6132702919233723`*^9}, {3.6132704115135593`*^9, 
   3.6132704960155125`*^9}, {3.613270893195776*^9, 3.6132709434040174`*^9}, {
   3.6132725099052896`*^9, 3.613272551364745*^9}, {3.613272836399482*^9, 
   3.613272923967463*^9}, {3.6132729680786705`*^9, 3.6132729696957445`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"k0:\"\>"], "Print",
 CellChangeTimes->{
  3.613202158125064*^9, 3.6132022743866367`*^9, 3.61320322226856*^9, 
   3.6132040428372335`*^9, 3.613204340875431*^9, 3.613211030970745*^9, 
   3.613211597349513*^9, 3.613216284550023*^9, 3.613220334397612*^9, {
   3.613220725242409*^9, 3.6132207373434267`*^9}, 3.6132207932024097`*^9, 
   3.613220852550709*^9, 3.6132215515385447`*^9, 3.61322163874629*^9, {
   3.6132217575379477`*^9, 3.6132217726319437`*^9}, {3.6132218125773983`*^9, 
   3.613221832663702*^9}, 3.613225804056325*^9, 3.6132259903356686`*^9, 
   3.6132261543532753`*^9, 3.6132264184571505`*^9, 3.6132264843307686`*^9, 
   3.613226560753374*^9, 3.6132274959962673`*^9, 3.6132277882697973`*^9, 
   3.6132278250461493`*^9, 3.6132374672047796`*^9, 3.6132399226886663`*^9, 
   3.613239999256365*^9, 3.6132400351741467`*^9, 3.61324018999266*^9, 
   3.6132403095578327`*^9, 3.6132403620295753`*^9, 3.613240662811677*^9, 
   3.6132407618412495`*^9, 3.6132537812044764`*^9, 3.6132539601519675`*^9, 
   3.6132570953332806`*^9, 3.613258601502425*^9, 3.6132590657985945`*^9, 
   3.6132597707954006`*^9, {3.613259865387035*^9, 3.613259869812965*^9}, {
   3.6132599339849195`*^9, 3.6132599383818293`*^9}, 3.6132600811351566`*^9, {
   3.6132634285980663`*^9, 3.6132634397544537`*^9}, 3.613263480438393*^9, {
   3.6132635128138285`*^9, 3.6132635206920457`*^9}, {3.6132635528983727`*^9, 
   3.613263565318597*^9}, {3.613263679728353*^9, 3.613263696491452*^9}, {
   3.6132637542346883`*^9, 3.613263780384004*^9}, {3.61326400955875*^9, 
   3.6132640567259846`*^9}, 3.6132690252370996`*^9, 3.6132691506130033`*^9, 
   3.6132691846844645`*^9, 3.6132692731730556`*^9, 3.613270945895667*^9, {
   3.613272526553315*^9, 3.613272554244649*^9}, 3.613272872400317*^9, 
   3.6132729285464954`*^9, 3.613272972789791*^9}],

Cell[BoxData["\<\"Fk:\"\>"], "Print",
 CellChangeTimes->{
  3.613202158125064*^9, 3.6132022743866367`*^9, 3.61320322226856*^9, 
   3.6132040428372335`*^9, 3.613204340875431*^9, 3.613211030970745*^9, 
   3.613211597349513*^9, 3.613216284550023*^9, 3.613220334397612*^9, {
   3.613220725242409*^9, 3.6132207373434267`*^9}, 3.6132207932024097`*^9, 
   3.613220852550709*^9, 3.6132215515385447`*^9, 3.61322163874629*^9, {
   3.6132217575379477`*^9, 3.6132217726319437`*^9}, {3.6132218125773983`*^9, 
   3.613221832663702*^9}, 3.613225804056325*^9, 3.6132259903356686`*^9, 
   3.6132261543532753`*^9, 3.6132264184571505`*^9, 3.6132264843307686`*^9, 
   3.613226560753374*^9, 3.6132274959962673`*^9, 3.6132277882697973`*^9, 
   3.6132278250461493`*^9, 3.6132374672047796`*^9, 3.6132399226886663`*^9, 
   3.613239999256365*^9, 3.6132400351741467`*^9, 3.61324018999266*^9, 
   3.6132403095578327`*^9, 3.6132403620295753`*^9, 3.613240662811677*^9, 
   3.6132407618412495`*^9, 3.6132537812044764`*^9, 3.6132539601519675`*^9, 
   3.6132570953332806`*^9, 3.613258601502425*^9, 3.6132590657985945`*^9, 
   3.6132597707954006`*^9, {3.613259865387035*^9, 3.613259869812965*^9}, {
   3.6132599339849195`*^9, 3.6132599383818293`*^9}, 3.6132600811351566`*^9, {
   3.6132634285980663`*^9, 3.6132634397544537`*^9}, 3.613263480438393*^9, {
   3.6132635128138285`*^9, 3.6132635206920457`*^9}, {3.6132635528983727`*^9, 
   3.613263565318597*^9}, {3.613263679728353*^9, 3.613263696491452*^9}, {
   3.6132637542346883`*^9, 3.613263780384004*^9}, {3.61326400955875*^9, 
   3.6132640567259846`*^9}, 3.6132690252370996`*^9, 3.6132691506130033`*^9, 
   3.6132691846844645`*^9, 3.6132692731730556`*^9, 3.613270945895667*^9, {
   3.613272526553315*^9, 3.613272554244649*^9}, 3.613272872400317*^9, 
   3.6132729285464954`*^9, 3.6132729727917914`*^9}],

Cell[BoxData["\<\"kr:\"\>"], "Print",
 CellChangeTimes->{
  3.613202158125064*^9, 3.6132022743866367`*^9, 3.61320322226856*^9, 
   3.6132040428372335`*^9, 3.613204340875431*^9, 3.613211030970745*^9, 
   3.613211597349513*^9, 3.613216284550023*^9, 3.613220334397612*^9, {
   3.613220725242409*^9, 3.6132207373434267`*^9}, 3.6132207932024097`*^9, 
   3.613220852550709*^9, 3.6132215515385447`*^9, 3.61322163874629*^9, {
   3.6132217575379477`*^9, 3.6132217726319437`*^9}, {3.6132218125773983`*^9, 
   3.613221832663702*^9}, 3.613225804056325*^9, 3.6132259903356686`*^9, 
   3.6132261543532753`*^9, 3.6132264184571505`*^9, 3.6132264843307686`*^9, 
   3.613226560753374*^9, 3.6132274959962673`*^9, 3.6132277882697973`*^9, 
   3.6132278250461493`*^9, 3.6132374672047796`*^9, 3.6132399226886663`*^9, 
   3.613239999256365*^9, 3.6132400351741467`*^9, 3.61324018999266*^9, 
   3.6132403095578327`*^9, 3.6132403620295753`*^9, 3.613240662811677*^9, 
   3.6132407618412495`*^9, 3.6132537812044764`*^9, 3.6132539601519675`*^9, 
   3.6132570953332806`*^9, 3.613258601502425*^9, 3.6132590657985945`*^9, 
   3.6132597707954006`*^9, {3.613259865387035*^9, 3.613259869812965*^9}, {
   3.6132599339849195`*^9, 3.6132599383818293`*^9}, 3.6132600811351566`*^9, {
   3.6132634285980663`*^9, 3.6132634397544537`*^9}, 3.613263480438393*^9, {
   3.6132635128138285`*^9, 3.6132635206920457`*^9}, {3.6132635528983727`*^9, 
   3.613263565318597*^9}, {3.613263679728353*^9, 3.613263696491452*^9}, {
   3.6132637542346883`*^9, 3.613263780384004*^9}, {3.61326400955875*^9, 
   3.6132640567259846`*^9}, 3.6132690252370996`*^9, 3.6132691506130033`*^9, 
   3.6132691846844645`*^9, 3.6132692731730556`*^9, 3.613270945895667*^9, {
   3.613272526553315*^9, 3.613272554244649*^9}, 3.613272872400317*^9, 
   3.6132729285464954`*^9, 3.6132729727937927`*^9}],

Cell[BoxData["\<\"qr:\"\>"], "Print",
 CellChangeTimes->{
  3.613202158125064*^9, 3.6132022743866367`*^9, 3.61320322226856*^9, 
   3.6132040428372335`*^9, 3.613204340875431*^9, 3.613211030970745*^9, 
   3.613211597349513*^9, 3.613216284550023*^9, 3.613220334397612*^9, {
   3.613220725242409*^9, 3.6132207373434267`*^9}, 3.6132207932024097`*^9, 
   3.613220852550709*^9, 3.6132215515385447`*^9, 3.61322163874629*^9, {
   3.6132217575379477`*^9, 3.6132217726319437`*^9}, {3.6132218125773983`*^9, 
   3.613221832663702*^9}, 3.613225804056325*^9, 3.6132259903356686`*^9, 
   3.6132261543532753`*^9, 3.6132264184571505`*^9, 3.6132264843307686`*^9, 
   3.613226560753374*^9, 3.6132274959962673`*^9, 3.6132277882697973`*^9, 
   3.6132278250461493`*^9, 3.6132374672047796`*^9, 3.6132399226886663`*^9, 
   3.613239999256365*^9, 3.6132400351741467`*^9, 3.61324018999266*^9, 
   3.6132403095578327`*^9, 3.6132403620295753`*^9, 3.613240662811677*^9, 
   3.6132407618412495`*^9, 3.6132537812044764`*^9, 3.6132539601519675`*^9, 
   3.6132570953332806`*^9, 3.613258601502425*^9, 3.6132590657985945`*^9, 
   3.6132597707954006`*^9, {3.613259865387035*^9, 3.613259869812965*^9}, {
   3.6132599339849195`*^9, 3.6132599383818293`*^9}, 3.6132600811351566`*^9, {
   3.6132634285980663`*^9, 3.6132634397544537`*^9}, 3.613263480438393*^9, {
   3.6132635128138285`*^9, 3.6132635206920457`*^9}, {3.6132635528983727`*^9, 
   3.613263565318597*^9}, {3.613263679728353*^9, 3.613263696491452*^9}, {
   3.6132637542346883`*^9, 3.613263780384004*^9}, {3.61326400955875*^9, 
   3.6132640567259846`*^9}, 3.6132690252370996`*^9, 3.6132691506130033`*^9, 
   3.6132691846844645`*^9, 3.6132692731730556`*^9, 3.613270945895667*^9, {
   3.613272526553315*^9, 3.613272554244649*^9}, 3.613272872400317*^9, 
   3.6132729285464954`*^9, 3.6132729727967944`*^9}],

Cell[BoxData["\<\"Rk:\"\>"], "Print",
 CellChangeTimes->{
  3.613202158125064*^9, 3.6132022743866367`*^9, 3.61320322226856*^9, 
   3.6132040428372335`*^9, 3.613204340875431*^9, 3.613211030970745*^9, 
   3.613211597349513*^9, 3.613216284550023*^9, 3.613220334397612*^9, {
   3.613220725242409*^9, 3.6132207373434267`*^9}, 3.6132207932024097`*^9, 
   3.613220852550709*^9, 3.6132215515385447`*^9, 3.61322163874629*^9, {
   3.6132217575379477`*^9, 3.6132217726319437`*^9}, {3.6132218125773983`*^9, 
   3.613221832663702*^9}, 3.613225804056325*^9, 3.6132259903356686`*^9, 
   3.6132261543532753`*^9, 3.6132264184571505`*^9, 3.6132264843307686`*^9, 
   3.613226560753374*^9, 3.6132274959962673`*^9, 3.6132277882697973`*^9, 
   3.6132278250461493`*^9, 3.6132374672047796`*^9, 3.6132399226886663`*^9, 
   3.613239999256365*^9, 3.6132400351741467`*^9, 3.61324018999266*^9, 
   3.6132403095578327`*^9, 3.6132403620295753`*^9, 3.613240662811677*^9, 
   3.6132407618412495`*^9, 3.6132537812044764`*^9, 3.6132539601519675`*^9, 
   3.6132570953332806`*^9, 3.613258601502425*^9, 3.6132590657985945`*^9, 
   3.6132597707954006`*^9, {3.613259865387035*^9, 3.613259869812965*^9}, {
   3.6132599339849195`*^9, 3.6132599383818293`*^9}, 3.6132600811351566`*^9, {
   3.6132634285980663`*^9, 3.6132634397544537`*^9}, 3.613263480438393*^9, {
   3.6132635128138285`*^9, 3.6132635206920457`*^9}, {3.6132635528983727`*^9, 
   3.613263565318597*^9}, {3.613263679728353*^9, 3.613263696491452*^9}, {
   3.6132637542346883`*^9, 3.613263780384004*^9}, {3.61326400955875*^9, 
   3.6132640567259846`*^9}, 3.6132690252370996`*^9, 3.6132691506130033`*^9, 
   3.6132691846844645`*^9, 3.6132692731730556`*^9, 3.613270945895667*^9, {
   3.613272526553315*^9, 3.613272554244649*^9}, 3.613272872400317*^9, 
   3.6132729285464954`*^9, 3.6132729727977953`*^9}],

Cell[BoxData["\<\"Fq:\"\>"], "Print",
 CellChangeTimes->{
  3.613202158125064*^9, 3.6132022743866367`*^9, 3.61320322226856*^9, 
   3.6132040428372335`*^9, 3.613204340875431*^9, 3.613211030970745*^9, 
   3.613211597349513*^9, 3.613216284550023*^9, 3.613220334397612*^9, {
   3.613220725242409*^9, 3.6132207373434267`*^9}, 3.6132207932024097`*^9, 
   3.613220852550709*^9, 3.6132215515385447`*^9, 3.61322163874629*^9, {
   3.6132217575379477`*^9, 3.6132217726319437`*^9}, {3.6132218125773983`*^9, 
   3.613221832663702*^9}, 3.613225804056325*^9, 3.6132259903356686`*^9, 
   3.6132261543532753`*^9, 3.6132264184571505`*^9, 3.6132264843307686`*^9, 
   3.613226560753374*^9, 3.6132274959962673`*^9, 3.6132277882697973`*^9, 
   3.6132278250461493`*^9, 3.6132374672047796`*^9, 3.6132399226886663`*^9, 
   3.613239999256365*^9, 3.6132400351741467`*^9, 3.61324018999266*^9, 
   3.6132403095578327`*^9, 3.6132403620295753`*^9, 3.613240662811677*^9, 
   3.6132407618412495`*^9, 3.6132537812044764`*^9, 3.6132539601519675`*^9, 
   3.6132570953332806`*^9, 3.613258601502425*^9, 3.6132590657985945`*^9, 
   3.6132597707954006`*^9, {3.613259865387035*^9, 3.613259869812965*^9}, {
   3.6132599339849195`*^9, 3.6132599383818293`*^9}, 3.6132600811351566`*^9, {
   3.6132634285980663`*^9, 3.6132634397544537`*^9}, 3.613263480438393*^9, {
   3.6132635128138285`*^9, 3.6132635206920457`*^9}, {3.6132635528983727`*^9, 
   3.613263565318597*^9}, {3.613263679728353*^9, 3.613263696491452*^9}, {
   3.6132637542346883`*^9, 3.613263780384004*^9}, {3.61326400955875*^9, 
   3.6132640567259846`*^9}, 3.6132690252370996`*^9, 3.6132691506130033`*^9, 
   3.6132691846844645`*^9, 3.6132692731730556`*^9, 3.613270945895667*^9, {
   3.613272526553315*^9, 3.613272554244649*^9}, 3.613272872400317*^9, 
   3.6132729285464954`*^9, 3.613272972799797*^9}],

Cell[BoxData["\<\"Fin:\"\>"], "Print",
 CellChangeTimes->{
  3.613202158125064*^9, 3.6132022743866367`*^9, 3.61320322226856*^9, 
   3.6132040428372335`*^9, 3.613204340875431*^9, 3.613211030970745*^9, 
   3.613211597349513*^9, 3.613216284550023*^9, 3.613220334397612*^9, {
   3.613220725242409*^9, 3.6132207373434267`*^9}, 3.6132207932024097`*^9, 
   3.613220852550709*^9, 3.6132215515385447`*^9, 3.61322163874629*^9, {
   3.6132217575379477`*^9, 3.6132217726319437`*^9}, {3.6132218125773983`*^9, 
   3.613221832663702*^9}, 3.613225804056325*^9, 3.6132259903356686`*^9, 
   3.6132261543532753`*^9, 3.6132264184571505`*^9, 3.6132264843307686`*^9, 
   3.613226560753374*^9, 3.6132274959962673`*^9, 3.6132277882697973`*^9, 
   3.6132278250461493`*^9, 3.6132374672047796`*^9, 3.6132399226886663`*^9, 
   3.613239999256365*^9, 3.6132400351741467`*^9, 3.61324018999266*^9, 
   3.6132403095578327`*^9, 3.6132403620295753`*^9, 3.613240662811677*^9, 
   3.6132407618412495`*^9, 3.6132537812044764`*^9, 3.6132539601519675`*^9, 
   3.6132570953332806`*^9, 3.613258601502425*^9, 3.6132590657985945`*^9, 
   3.6132597707954006`*^9, {3.613259865387035*^9, 3.613259869812965*^9}, {
   3.6132599339849195`*^9, 3.6132599383818293`*^9}, 3.6132600811351566`*^9, {
   3.6132634285980663`*^9, 3.6132634397544537`*^9}, 3.613263480438393*^9, {
   3.6132635128138285`*^9, 3.6132635206920457`*^9}, {3.6132635528983727`*^9, 
   3.613263565318597*^9}, {3.613263679728353*^9, 3.613263696491452*^9}, {
   3.6132637542346883`*^9, 3.613263780384004*^9}, {3.61326400955875*^9, 
   3.6132640567259846`*^9}, 3.6132690252370996`*^9, 3.6132691506130033`*^9, 
   3.6132691846844645`*^9, 3.6132692731730556`*^9, 3.613270945895667*^9, {
   3.613272526553315*^9, 3.613272554244649*^9}, 3.613272872400317*^9, 
   3.6132729285464954`*^9, 3.613272972801798*^9}],

Cell[BoxData["\<\"Rq:\"\>"], "Print",
 CellChangeTimes->{
  3.613202158125064*^9, 3.6132022743866367`*^9, 3.61320322226856*^9, 
   3.6132040428372335`*^9, 3.613204340875431*^9, 3.613211030970745*^9, 
   3.613211597349513*^9, 3.613216284550023*^9, 3.613220334397612*^9, {
   3.613220725242409*^9, 3.6132207373434267`*^9}, 3.6132207932024097`*^9, 
   3.613220852550709*^9, 3.6132215515385447`*^9, 3.61322163874629*^9, {
   3.6132217575379477`*^9, 3.6132217726319437`*^9}, {3.6132218125773983`*^9, 
   3.613221832663702*^9}, 3.613225804056325*^9, 3.6132259903356686`*^9, 
   3.6132261543532753`*^9, 3.6132264184571505`*^9, 3.6132264843307686`*^9, 
   3.613226560753374*^9, 3.6132274959962673`*^9, 3.6132277882697973`*^9, 
   3.6132278250461493`*^9, 3.6132374672047796`*^9, 3.6132399226886663`*^9, 
   3.613239999256365*^9, 3.6132400351741467`*^9, 3.61324018999266*^9, 
   3.6132403095578327`*^9, 3.6132403620295753`*^9, 3.613240662811677*^9, 
   3.6132407618412495`*^9, 3.6132537812044764`*^9, 3.6132539601519675`*^9, 
   3.6132570953332806`*^9, 3.613258601502425*^9, 3.6132590657985945`*^9, 
   3.6132597707954006`*^9, {3.613259865387035*^9, 3.613259869812965*^9}, {
   3.6132599339849195`*^9, 3.6132599383818293`*^9}, 3.6132600811351566`*^9, {
   3.6132634285980663`*^9, 3.6132634397544537`*^9}, 3.613263480438393*^9, {
   3.6132635128138285`*^9, 3.6132635206920457`*^9}, {3.6132635528983727`*^9, 
   3.613263565318597*^9}, {3.613263679728353*^9, 3.613263696491452*^9}, {
   3.6132637542346883`*^9, 3.613263780384004*^9}, {3.61326400955875*^9, 
   3.6132640567259846`*^9}, 3.6132690252370996`*^9, 3.6132691506130033`*^9, 
   3.6132691846844645`*^9, 3.6132692731730556`*^9, 3.613270945895667*^9, {
   3.613272526553315*^9, 3.613272554244649*^9}, 3.613272872400317*^9, 
   3.6132729285464954`*^9, 3.6132729728037996`*^9}],

Cell[BoxData["\<\"qsum:\"\>"], "Print",
 CellChangeTimes->{
  3.613202158125064*^9, 3.6132022743866367`*^9, 3.61320322226856*^9, 
   3.6132040428372335`*^9, 3.613204340875431*^9, 3.613211030970745*^9, 
   3.613211597349513*^9, 3.613216284550023*^9, 3.613220334397612*^9, {
   3.613220725242409*^9, 3.6132207373434267`*^9}, 3.6132207932024097`*^9, 
   3.613220852550709*^9, 3.6132215515385447`*^9, 3.61322163874629*^9, {
   3.6132217575379477`*^9, 3.6132217726319437`*^9}, {3.6132218125773983`*^9, 
   3.613221832663702*^9}, 3.613225804056325*^9, 3.6132259903356686`*^9, 
   3.6132261543532753`*^9, 3.6132264184571505`*^9, 3.6132264843307686`*^9, 
   3.613226560753374*^9, 3.6132274959962673`*^9, 3.6132277882697973`*^9, 
   3.6132278250461493`*^9, 3.6132374672047796`*^9, 3.6132399226886663`*^9, 
   3.613239999256365*^9, 3.6132400351741467`*^9, 3.61324018999266*^9, 
   3.6132403095578327`*^9, 3.6132403620295753`*^9, 3.613240662811677*^9, 
   3.6132407618412495`*^9, 3.6132537812044764`*^9, 3.6132539601519675`*^9, 
   3.6132570953332806`*^9, 3.613258601502425*^9, 3.6132590657985945`*^9, 
   3.6132597707954006`*^9, {3.613259865387035*^9, 3.613259869812965*^9}, {
   3.6132599339849195`*^9, 3.6132599383818293`*^9}, 3.6132600811351566`*^9, {
   3.6132634285980663`*^9, 3.6132634397544537`*^9}, 3.613263480438393*^9, {
   3.6132635128138285`*^9, 3.6132635206920457`*^9}, {3.6132635528983727`*^9, 
   3.613263565318597*^9}, {3.613263679728353*^9, 3.613263696491452*^9}, {
   3.6132637542346883`*^9, 3.613263780384004*^9}, {3.61326400955875*^9, 
   3.6132640567259846`*^9}, 3.6132690252370996`*^9, 3.6132691506130033`*^9, 
   3.6132691846844645`*^9, 3.6132692731730556`*^9, 3.613270945895667*^9, {
   3.613272526553315*^9, 3.613272554244649*^9}, 3.613272872400317*^9, 
   3.6132729285464954`*^9, 3.6132729728058014`*^9}],

Cell[BoxData["\<\"Check:\"\>"], "Print",
 CellChangeTimes->{
  3.613202158125064*^9, 3.6132022743866367`*^9, 3.61320322226856*^9, 
   3.6132040428372335`*^9, 3.613204340875431*^9, 3.613211030970745*^9, 
   3.613211597349513*^9, 3.613216284550023*^9, 3.613220334397612*^9, {
   3.613220725242409*^9, 3.6132207373434267`*^9}, 3.6132207932024097`*^9, 
   3.613220852550709*^9, 3.6132215515385447`*^9, 3.61322163874629*^9, {
   3.6132217575379477`*^9, 3.6132217726319437`*^9}, {3.6132218125773983`*^9, 
   3.613221832663702*^9}, 3.613225804056325*^9, 3.6132259903356686`*^9, 
   3.6132261543532753`*^9, 3.6132264184571505`*^9, 3.6132264843307686`*^9, 
   3.613226560753374*^9, 3.6132274959962673`*^9, 3.6132277882697973`*^9, 
   3.6132278250461493`*^9, 3.6132374672047796`*^9, 3.6132399226886663`*^9, 
   3.613239999256365*^9, 3.6132400351741467`*^9, 3.61324018999266*^9, 
   3.6132403095578327`*^9, 3.6132403620295753`*^9, 3.613240662811677*^9, 
   3.6132407618412495`*^9, 3.6132537812044764`*^9, 3.6132539601519675`*^9, 
   3.6132570953332806`*^9, 3.613258601502425*^9, 3.6132590657985945`*^9, 
   3.6132597707954006`*^9, {3.613259865387035*^9, 3.613259869812965*^9}, {
   3.6132599339849195`*^9, 3.6132599383818293`*^9}, 3.6132600811351566`*^9, {
   3.6132634285980663`*^9, 3.6132634397544537`*^9}, 3.613263480438393*^9, {
   3.6132635128138285`*^9, 3.6132635206920457`*^9}, {3.6132635528983727`*^9, 
   3.613263565318597*^9}, {3.613263679728353*^9, 3.613263696491452*^9}, {
   3.6132637542346883`*^9, 3.613263780384004*^9}, {3.61326400955875*^9, 
   3.6132640567259846`*^9}, 3.6132690252370996`*^9, 3.6132691506130033`*^9, 
   3.6132691846844645`*^9, 3.6132692731730556`*^9, 3.613270945895667*^9, {
   3.613272526553315*^9, 3.613272554244649*^9}, 3.613272872400317*^9, 
   3.6132729285464954`*^9, 3.613272972807802*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4809.652869042324`"}], ",", 
     RowBox[{"-", "3870.659065653963`"}], ",", "1155.8339907864474`", ",", 
     "2500.`", ",", "2499.9990000004`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2500.`", ",", "2500.`", ",", "2500.`", ",", "2168.681690363361`", ",", 
     "2500.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2500.`", ",", "167.721887698886`", ",", "634.5189534450732`", ",", 
     "2500.`", ",", "155.05520553785317`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2500.`", ",", "935.8014537341411`", ",", "803.264007778585`", ",", 
     "1243.0197365818565`", ",", "2500.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2418.471442457041`"}], ",", "2348.739640413119`", ",", 
     "1346.53666391063`", ",", "1372.8385756134778`", ",", 
     "1019.4561393415554`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "932.438851837155`", ",", "1317.7314832996558`", ",", 
     "1848.1307263922881`", ",", "717.1083864450566`", ",", 
     "1581.8905906992597`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1116.9756632117767`", ",", "484.8664401423839`", ",", 
     RowBox[{"-", "1274.90510802281`"}], ",", "1340.6287046182506`", ",", 
     "2500.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "252.3220125831635`", ",", "345.0401094335796`", ",", 
     "1024.3565769969891`", ",", "2500.`", ",", "175.3998329381723`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.613176255945014*^9, 3.613176339807026*^9, 3.6131763915135603`*^9, {
   3.6131765244013176`*^9, 3.613176571205574*^9}, 3.613177725693309*^9, 
   3.6131777878498244`*^9, 3.613178227597287*^9, 3.613202158128066*^9, 
   3.6132022743886375`*^9, 3.6132032222715592`*^9, 3.6132040428392353`*^9, 
   3.6132043408904405`*^9, 3.6132110309827504`*^9, 3.6132115973615217`*^9, 
   3.61321628455903*^9, 3.6132203344056153`*^9, {3.6132207252474136`*^9, 
   3.613220737348426*^9}, 3.613220793208413*^9, 3.6132208525547104`*^9, 
   3.6132215515445547`*^9, 3.613221638750292*^9, {3.6132217575419497`*^9, 
   3.6132217726369467`*^9}, {3.613221812583397*^9, 3.6132218326707*^9}, 
   3.613225804062326*^9, 3.613225990341672*^9, 3.6132261543582754`*^9, 
   3.6132264184771647`*^9, 3.6132264843497825`*^9, 3.6132265607693834`*^9, 
   3.613227496248434*^9, 3.613227788638042*^9, 3.613227825395382*^9, 
   3.6132374672187862`*^9, 3.613239922717683*^9, 3.6132399992823806`*^9, 
   3.613240035193159*^9, 3.613240190011674*^9, 3.6132403095788465`*^9, 
   3.6132403620375814`*^9, 3.61324066281868*^9, 3.6132407618482523`*^9, 
   3.6132537812284923`*^9, 3.613253960169979*^9, 3.6132570953492913`*^9, 
   3.6132586015164337`*^9, 3.613259065815604*^9, 3.6132597708084087`*^9, {
   3.6132598654030447`*^9, 3.613259869828975*^9}, {3.6132599340029297`*^9, 
   3.613259938403843*^9}, 3.613260081151166*^9, {3.613263428633089*^9, 
   3.613263439768462*^9}, 3.6132634804554033`*^9, {3.6132635128288383`*^9, 
   3.6132635207060556`*^9}, {3.6132635529183836`*^9, 3.613263565335606*^9}, {
   3.613263679744364*^9, 3.613263696508463*^9}, {3.613263754254699*^9, 
   3.613263780406017*^9}, {3.6132640095777626`*^9, 3.6132640567429924`*^9}, 
   3.613269025243103*^9, 3.613269150618002*^9, 3.6132691846894665`*^9, 
   3.6132692731770587`*^9, 3.613270945900672*^9, {3.6132725265573153`*^9, 
   3.613272554258658*^9}, 3.6132728724413443`*^9, 3.6132729285695105`*^9, 
   3.6132729728108044`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4809.652869042324`"}], ",", 
     RowBox[{"-", "3870.659065653963`"}], ",", "1000.`", ",", "2500.`", ",", 
     "2499.9990000004`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2500.`", ",", "2500.`", ",", "1000.`", ",", "2168.681690363361`", ",", 
     "2500.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2500.`", ",", "167.721887698886`", ",", "634.5189534450732`", ",", 
     "2500.`", ",", "155.05520553785317`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2500.`", ",", "935.8014537341411`", ",", "803.264007778585`", ",", 
     "1243.0197365818565`", ",", "2500.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2418.471442457041`"}], ",", "2348.739640413119`", ",", 
     "1000.`", ",", "1372.8385756134778`", ",", "1019.4561393415554`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "932.438851837155`", ",", "1317.7314832996558`", ",", "1000.`", ",", 
     "717.1083864450566`", ",", "1581.8905906992597`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1116.9756632117767`", ",", "484.8664401423839`", ",", 
     RowBox[{"-", "1274.90510802281`"}], ",", "1340.6287046182506`", ",", 
     "2500.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "252.3220125831635`", ",", "345.0401094335796`", ",", "1000.`", ",", 
     "2500.`", ",", "175.3998329381723`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.613176255945014*^9, 3.613176339807026*^9, 3.6131763915135603`*^9, {
   3.6131765244013176`*^9, 3.613176571205574*^9}, 3.613177725693309*^9, 
   3.6131777878498244`*^9, 3.613178227597287*^9, 3.613202158128066*^9, 
   3.6132022743886375`*^9, 3.6132032222715592`*^9, 3.6132040428392353`*^9, 
   3.6132043408904405`*^9, 3.6132110309827504`*^9, 3.6132115973615217`*^9, 
   3.61321628455903*^9, 3.6132203344056153`*^9, {3.6132207252474136`*^9, 
   3.613220737348426*^9}, 3.613220793208413*^9, 3.6132208525547104`*^9, 
   3.6132215515445547`*^9, 3.613221638750292*^9, {3.6132217575419497`*^9, 
   3.6132217726369467`*^9}, {3.613221812583397*^9, 3.6132218326707*^9}, 
   3.613225804062326*^9, 3.613225990341672*^9, 3.6132261543582754`*^9, 
   3.6132264184771647`*^9, 3.6132264843497825`*^9, 3.6132265607693834`*^9, 
   3.613227496248434*^9, 3.613227788638042*^9, 3.613227825395382*^9, 
   3.6132374672187862`*^9, 3.613239922717683*^9, 3.6132399992823806`*^9, 
   3.613240035193159*^9, 3.613240190011674*^9, 3.6132403095788465`*^9, 
   3.6132403620375814`*^9, 3.61324066281868*^9, 3.6132407618482523`*^9, 
   3.6132537812284923`*^9, 3.613253960169979*^9, 3.6132570953492913`*^9, 
   3.6132586015164337`*^9, 3.613259065815604*^9, 3.6132597708084087`*^9, {
   3.6132598654030447`*^9, 3.613259869828975*^9}, {3.6132599340029297`*^9, 
   3.613259938403843*^9}, 3.613260081151166*^9, {3.613263428633089*^9, 
   3.613263439768462*^9}, 3.6132634804554033`*^9, {3.6132635128288383`*^9, 
   3.6132635207060556`*^9}, {3.6132635529183836`*^9, 3.613263565335606*^9}, {
   3.613263679744364*^9, 3.613263696508463*^9}, {3.613263754254699*^9, 
   3.613263780406017*^9}, {3.6132640095777626`*^9, 3.6132640567429924`*^9}, 
   3.613269025243103*^9, 3.613269150618002*^9, 3.6132691846894665`*^9, 
   3.6132692731770587`*^9, 3.613270945900672*^9, {3.6132725265573153`*^9, 
   3.613272554258658*^9}, 3.6132728724413443`*^9, 3.6132729285695105`*^9, 
   3.6132729728138065`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"aa_", ",", "a21_", ",", "a22_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{"aa", ",", "a21", ",", "a22"}], "]"}], "=", 
       RowBox[{"f", "[", 
        RowBox[{"aa", ",", "a21", ",", "a22"}], "]"}]}]}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{"f", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Kj", "=", "150."}], ",", 
         RowBox[{"w", "=", "20."}], ",", 
         RowBox[{"Vf", "=", "100."}], ",", 
         RowBox[{"cap", "=", "2500."}], ",", 
         RowBox[{"n", "=", "90"}], ",", 
         RowBox[{"m", "=", "225"}], ",", 
         RowBox[{"p", "=", "85"}], ",", 
         RowBox[{"RML", "=", "45"}], ",", 
         RowBox[{"L", "=", "3."}], ",", 
         RowBox[{"delta", "=", "1."}], ",", 
         RowBox[{"dt", "=", 
          RowBox[{"4.", "/", "3600."}]}], ",", 
         RowBox[{"dx", "=", 
          RowBox[{"1.", "/", "9."}]}], ",", 
         RowBox[{"Ssteps", "=", "10."}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"aa", ",", "_Integer", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a21", ",", "_Real", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a22", ",", "_Real", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "=", "a21"}], ",", 
             RowBox[{"b", "=", "a22"}], ",", 
             RowBox[{"k0", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0.", ",", 
                RowBox[{"{", "n", "}"}]}], "]"}]}], ",", 
             RowBox[{"Fk", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0.", ",", 
                RowBox[{"{", "5", "}"}], ",", 
                RowBox[{"{", "n", "}"}]}], "]"}]}], ",", 
             RowBox[{"kr", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0.", ",", 
                RowBox[{"{", 
                 RowBox[{"n", "-", "2"}], "}"}], ",", 
                RowBox[{"{", "p", "}"}]}], "]"}]}], ",", 
             RowBox[{"Rk", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0.", ",", 
                RowBox[{"{", "4", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", "-", "2"}], "}"}], ",", 
                RowBox[{"{", "p", "}"}]}], "]"}]}], ",", 
             RowBox[{"Fq", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0.", ",", 
                RowBox[{"{", "4", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", "-", "1"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"Fin", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0.", ",", 
                RowBox[{"{", "4", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", "-", "2"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"Rq", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0.", ",", 
                RowBox[{"{", "4", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", "-", "2"}], "}"}], ",", 
                RowBox[{"{", "p", "}"}]}], "]"}]}], ",", 
             RowBox[{"Shutoff", "=", "False"}], ",", 
             RowBox[{"j", "=", "1."}], ",", "fi", ",", "qin", ",", "qr", ",", 
             "qf", ",", "qsum", ",", 
             RowBox[{"TT", "=", "0."}], ",", 
             RowBox[{"FTT", "=", "0."}], ",", 
             RowBox[{"RTT", "=", "0."}], ",", 
             RowBox[{"Tsteps", "=", 
              RowBox[{
               RowBox[{"Length", "[", "aa", "]"}], "/", "Ssteps"}]}], ",", 
             "RM", ",", "RMori"}], " ", "}"}], ",", 
           RowBox[{
            RowBox[{"RM", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"aa", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "Ssteps"}], "+", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"i", " ", "dx"}], "]"}], "<", "1"}], ",", " ", 
                    "1", ",", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"i", " ", "dx"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                " ", "100"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "Tsteps"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "2", ",", 
                 RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
            RowBox[{"RMori", "=", " ", 
             RowBox[{"RM", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
               RowBox[{"kr", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
               RowBox[{"a", " ", 
                RowBox[{"delta", "/", "Vf"}]}]}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"kr", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
             RowBox[{"a", " ", 
              RowBox[{"delta", "/", "Vf"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"kr", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"(", 
                    RowBox[{"a", " ", 
                    RowBox[{"delta", "/", "Vf"}]}], ")"}], ",", "1"}], "]"}], 
                 "&"}], "/@", "kr"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"RTT", "=", 
             RowBox[{"TT", "=", 
              RowBox[{
               RowBox[{"Total", "[", 
                RowBox[{"kr", ",", "2"}], "]"}], " ", "dx"}]}]}], ";", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"Rk", ",", "kr"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"TT", ">", "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"j", ",", "100"}], "]"}], "\[Equal]", " ", "0"}], 
                 ",", 
                 RowBox[{"RMori", "=", 
                  RowBox[{"RM", "[", 
                   RowBox[{"[", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "/", "100"}], ")"}], "+", "1"}], ",", 
                    "Tsteps"}], "]"}], "]"}], "]"}]}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"fi", "=", 
                RowBox[{
                 RowBox[{"demR", "[", 
                  RowBox[{"Last", "/@", "kr"}], "]"}], " ", 
                 RowBox[{"gamma", "[", 
                  RowBox[{
                   RowBox[{"Take", "[", 
                    RowBox[{"k0", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
                   RowBox[{"Take", "[", 
                    RowBox[{"k0", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"qf", "=", 
                RowBox[{
                 RowBox[{"Fq", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"j", ",", "4"}], "]"}], "+", "1"}], "]"}], "]"}], 
                 "=", 
                 RowBox[{"floF", "[", 
                  RowBox[{
                   RowBox[{"Most", "@", "k0"}], ",", 
                   RowBox[{"Rest", "@", 
                    RowBox[{"(", 
                    RowBox[{"Fk", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ")"}]}], ",", 
                   RowBox[{"Total", "@", "Fq"}], ",", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Total", "@", "Fin"}], ",", 
                    RowBox[{"{", "0.", "}"}]}], "]"}], ",", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"fi", " ", "dx"}], ",", 
                    RowBox[{"{", "0.", "}"}]}], "]"}]}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"qin", "=", 
                RowBox[{
                 RowBox[{"Fin", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"j", ",", "4"}], "]"}], "+", "1"}], "]"}], "]"}], 
                 "=", 
                 RowBox[{"inflow", "[", 
                  RowBox[{"fi", ",", 
                   RowBox[{"Most", "@", "qf"}]}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"Fk", "=", 
                RowBox[{"RotateLeft", "[", "Fk", "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"k0", "=", 
                RowBox[{
                 RowBox[{"Fk", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], "=", 
                 RowBox[{"updateF", "[", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "0.", "}"}], ",", 
                    RowBox[{"den", "[", 
                    RowBox[{
                    RowBox[{"Most", "@", "qf"}], ",", 
                    RowBox[{"Rest", "@", "qf"}], ",", "qin"}], "]"}], ",", 
                    RowBox[{"{", "0.", "}"}]}], "]"}], ",", "k0"}], "]"}]}]}],
                ";", "\[IndentingNewLine]", 
               RowBox[{"qsum", "=", 
                RowBox[{"Total", "@", "Rq"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"qr", "=", 
                RowBox[{"ArrayFlatten", "[", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"floR", "[", 
                    RowBox[{
                    RowBox[{"Most", "/@", "kr"}], ",", 
                    RowBox[{"Rest", "/@", 
                    RowBox[{"Rk", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"Most", "/@", "qsum"}]}], "]"}], ",", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"{", "fi", "}"}]}]}], "}"}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"qr", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "RML"}], "]"}], "]"}], "=", 
                RowBox[{"compiledMin", "[", 
                 RowBox[{"RMori", ",", 
                  RowBox[{"floR", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"kr", "\[Transpose]"}], "[", 
                    RowBox[{"[", "RML", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Rk", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"RML", "+", "1"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"qsum", "\[Transpose]"}], "[", 
                    RowBox[{"[", "RML", "]"}], "]"}]}], "]"}]}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Rq", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{"j", ",", "4"}], "]"}], "+", "1"}], "]"}], "]"}], 
                "=", "qr"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"Rk", "=", 
                RowBox[{"RotateLeft", "[", "Rk", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Rk", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], "=", 
                RowBox[{"kr", "+=", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "0.", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"den", "[", 
                    RowBox[{
                    RowBox[{"Most", "@", "#"}], ",", 
                    RowBox[{"Rest", "@", "#"}], ",", "0"}], "]"}], "&"}], "/@",
                     "qr"}], ")"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Shutoff", "\[Equal]", "False"}], ")"}], "&&", 
                  RowBox[{"j", ">", "m"}]}], ",", 
                 RowBox[{
                  RowBox[{"Shutoff", "=", "True"}], ";", 
                  RowBox[{
                   RowBox[{"kr", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", "0"}]}]}], 
                RowBox[{"(*", 
                 RowBox[{"kr", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{"#", ",", "0", ",", "1"}], "]"}], "&"}], "/@", 
                   "kr"}]}], "*)"}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"FTT", "+=", 
                RowBox[{"Total", "@", "k0"}]}], ";", 
               RowBox[{"RTT", "+=", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{"kr", ",", "2"}], "]"}], " ", "dx"}]}], ";", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"j", ">", "m"}], ",", 
                 RowBox[{"TT", "=", 
                  RowBox[{"Total", "@", "k0"}]}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"kr", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"RML", "+", "1"}]}], "]"}], "]"}], "]"}], ">", 
                  RowBox[{"Kj", "-", 
                   RowBox[{"a", "/", "w"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"Print", "[", "\"\<Meter Spillback\>\"", "]"}], ";", 
                  RowBox[{"RTT", "=", 
                   RowBox[{"10", "^", "10"}]}], ";", 
                  RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"kr", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ">", 
                  RowBox[{"Kj", "-", 
                   RowBox[{"a", "/", "w"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"Print", "[", "\"\<Ramp Spillback\>\"", "]"}], ";", 
                  RowBox[{"RTT", "=", 
                   RowBox[{"10", "^", "10"}]}], ";", 
                  RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"RML", "+", "1"}], "]"}], "]"}], "&"}], "/@", 
                    "kr"}], ")"}], "]"}], ">", 
                    RowBox[{"Kj", "-", 
                    RowBox[{"a", "/", "w"}]}]}], ",", 
                   RowBox[{
                    RowBox[{"Print", "[", "\"\<Meter Spillback\>\"", "]"}], 
                    ";", 
                    RowBox[{"RTT", "=", 
                    RowBox[{"10", "^", "10"}]}], ";", 
                    RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "kr"}], 
                    ")"}], "]"}], ">", 
                    RowBox[{"Kj", "-", 
                    RowBox[{"a", "/", "w"}]}]}], ",", 
                   RowBox[{
                    RowBox[{"Print", "[", "\"\<Ramp Spillback\>\"", "]"}], 
                    ";", 
                    RowBox[{"RTT", "=", 
                    RowBox[{"10", "^", "10"}]}], ";", 
                    RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}], "*)"}], 
               RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"RTT", "+", "FTT"}], ")"}], " ", "dt", " ", "dx"}]}]}], 
          "]"}], ",", 
         RowBox[{"CompilationOptions", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}], 
            ",", 
            RowBox[{
            "\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}]}], 
           "}"}]}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
      "]"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.612023226274868*^9, 3.612023308894287*^9}, {
   3.6120289429476037`*^9, 3.6120289539439216`*^9}, {3.612101981630884*^9, 
   3.612101985198258*^9}, {3.6121025294596176`*^9, 3.6121025323335314`*^9}, {
   3.612102691318324*^9, 3.612102757763501*^9}, {3.612102791329834*^9, 
   3.6121027983044767`*^9}, {3.6121028404124985`*^9, 3.61210286945282*^9}, {
   3.612102932444417*^9, 3.6121029930439796`*^9}, {3.6121034045060186`*^9, 
   3.6121034051274333`*^9}, 3.6121034432928295`*^9, {3.6121040749284916`*^9, 
   3.612104081288724*^9}, {3.6121042874909377`*^9, 3.6121043152434034`*^9}, 
   3.612104348956001*^9, {3.6121044008935633`*^9, 3.6121044106970897`*^9}, {
   3.6121045975849314`*^9, 3.612104628338397*^9}, {3.612104758575061*^9, 
   3.6121047834015822`*^9}, 3.612105008574419*^9, {3.612107413218937*^9, 
   3.6121074173316717`*^9}, {3.612117740528376*^9, 3.612117764633855*^9}, {
   3.61211795143198*^9, 3.612117963809216*^9}, {3.6121352013952565`*^9, 
   3.61213524918606*^9}, {3.6121352912550526`*^9, 3.6121353157598896`*^9}, 
   3.612135382307171*^9, {3.6121354410803804`*^9, 3.612135445719468*^9}, 
   3.6121359386107426`*^9, {3.6121362237563663`*^9, 3.6121362344324684`*^9}, {
   3.612136283289982*^9, 3.6121362842276077`*^9}, 3.6121363797928495`*^9, {
   3.6121364357718835`*^9, 3.612136441037386*^9}, {3.612136481830531*^9, 
   3.6121365009402485`*^9}, {3.612136621901739*^9, 3.6121366224491034`*^9}, 
   3.6121366821956425`*^9, 3.6121367935613904`*^9, 3.6121374551211495`*^9, {
   3.6121377361291466`*^9, 3.6121377566678143`*^9}, 3.6121378273888736`*^9, {
   3.612137890026557*^9, 3.6121378995458922`*^9}, {3.612138006934985*^9, 
   3.612138013689479*^9}, {3.6121380689132285`*^9, 3.612138072642709*^9}, {
   3.6121381029598846`*^9, 3.612138138015211*^9}, {3.6121381791966143`*^9, 
   3.6121382000524926`*^9}, 3.612138621872572*^9, 3.612139285687533*^9, {
   3.612139829954717*^9, 3.6121398306922083`*^9}, {3.6121400019191484`*^9, 
   3.612140002896799*^9}, {3.6121403567162437`*^9, 3.6121403589967613`*^9}, {
   3.6121409501006794`*^9, 3.612140971555807*^9}, {3.612141154598349*^9, 
   3.612141157954582*^9}, {3.6121427848922844`*^9, 3.612142815617729*^9}, {
   3.612142852346074*^9, 3.6121428531345987`*^9}, {3.6121429346179204`*^9, 
   3.6121430217879267`*^9}, {3.6121434206455793`*^9, 
   3.6121435428314466`*^9}, {3.61214378929737*^9, 3.612143844818313*^9}, {
   3.6121438912922425`*^9, 3.6121439017041674`*^9}, {3.6121439588341837`*^9, 
   3.6121439631550584`*^9}, {3.6121440113821526`*^9, 3.612144035573745*^9}, {
   3.612144121678812*^9, 3.61214414550871*^9}, {3.6121442110293083`*^9, 
   3.612144211846854*^9}, {3.6121442642887526`*^9, 3.6121442651493225`*^9}, {
   3.6121445699298344`*^9, 3.6121446122790127`*^9}, {3.61214470073869*^9, 
   3.612144707414133*^9}, {3.612147894199198*^9, 3.6121479539549613`*^9}, {
   3.612147994780312*^9, 3.612148002762624*^9}, {3.612148050310264*^9, 
   3.6121480513889823`*^9}, {3.612148109704789*^9, 3.6121481107864113`*^9}, {
   3.612152927999116*^9, 3.6121530898108883`*^9}, {3.6121531215540104`*^9, 
   3.6121531583254795`*^9}, 3.6121532031142845`*^9, {3.612153380795519*^9, 
   3.6121533898235292`*^9}, 3.61215343493047*^9, {3.6121551494603176`*^9, 
   3.6121551910248127`*^9}, {3.6121552247764397`*^9, 3.612155254746627*^9}, {
   3.6121555589018607`*^9, 3.6121555661990824`*^9}, {3.612155604857193*^9, 
   3.612155640608906*^9}, {3.612155673110471*^9, 3.612155677313798*^9}, {
   3.612155762218522*^9, 3.612155827924796*^9}, 3.612156201793826*^9, {
   3.612156623817785*^9, 3.6121566491335793`*^9}, {3.6121567718212786`*^9, 
   3.612156798325864*^9}, {3.612167700162096*^9, 3.6121677150189514`*^9}, 
   3.6121681342340517`*^9, 3.612170087589526*^9, {3.612170118192828*^9, 
   3.6121701227888784`*^9}, {3.612170202886012*^9, 3.612170217228527*^9}, {
   3.612170296098846*^9, 3.612170299469082*^9}, {3.612174859074157*^9, 
   3.612174868442374*^9}, {3.612174905478945*^9, 3.6121749141927223`*^9}, {
   3.6121750252794156`*^9, 3.612175049639578*^9}, {3.612175150496484*^9, 
   3.612175173207551*^9}, {3.6121752118951516`*^9, 3.612175223370763*^9}, {
   3.612175448705247*^9, 3.6121754490604815`*^9}, {3.612175480498337*^9, 
   3.6121757635180874`*^9}, {3.612175798662401*^9, 3.612175844638901*^9}, {
   3.6121758778239155`*^9, 3.61217602008529*^9}, {3.6121760528420196`*^9, 
   3.61217606138969*^9}, 3.6121771021585574`*^9, {3.612177193988475*^9, 
   3.612177221599792*^9}, {3.6121772758577876`*^9, 3.6121773079150524`*^9}, {
   3.6121773463505497`*^9, 3.6121773723628087`*^9}, {3.612177508486109*^9, 
   3.6121775182886114`*^9}, {3.6121777079724445`*^9, 
   3.6121777098366814`*^9}, {3.61217780819393*^9, 3.612177814319993*^9}, {
   3.6121778619678545`*^9, 3.61217788217126*^9}, {3.612177951333141*^9, 
   3.6121779608964834`*^9}, 3.612178139420913*^9, {3.6121865737842283`*^9, 
   3.612186577882946*^9}, 3.6121866430231586`*^9, 3.612186820490893*^9, {
   3.6121869451756015`*^9, 3.6121869494764566`*^9}, {3.6121920487112513`*^9, 
   3.6121921851107354`*^9}, {3.6121923389197707`*^9, 3.612192410475238*^9}, {
   3.6121932949433537`*^9, 3.6121933043555984`*^9}, {3.613145258627679*^9, 
   3.6131452651820555`*^9}, 3.613146451343665*^9, {3.6131464911512527`*^9, 
   3.613146516216993*^9}, {3.613146731736936*^9, 3.613146847413198*^9}, {
   3.613146890561015*^9, 3.613146973561451*^9}, {3.613169324335759*^9, 
   3.613169339950187*^9}, {3.613169607620963*^9, 3.613169621761407*^9}, {
   3.6131696691670694`*^9, 3.613169736955287*^9}, {3.613170403435175*^9, 
   3.6131704170822897`*^9}, 3.613170847742367*^9, {3.61317089967367*^9, 
   3.6131709432617826`*^9}, {3.613170983044354*^9, 3.613171091700926*^9}, {
   3.6131712304971*^9, 3.61317123582666*^9}, {3.6131715575355263`*^9, 
   3.613171564717324*^9}, {3.613171618303115*^9, 3.61317162942254*^9}, {
   3.6131717150787506`*^9, 3.613171747321285*^9}, {3.613171812665929*^9, 
   3.6131718389855723`*^9}, {3.613171915238168*^9, 3.61317196006711*^9}, {
   3.613172527292286*^9, 3.613172541035465*^9}, {3.6131726407830877`*^9, 
   3.6131727751758485`*^9}, {3.613172840674595*^9, 3.6131728637480073`*^9}, {
   3.613174067408613*^9, 3.6131740732525167`*^9}, {3.613201791601265*^9, 
   3.6132018156553307`*^9}, {3.613212499873122*^9, 3.613212537741413*^9}, {
   3.6132174791514783`*^9, 3.6132175015944653`*^9}, {3.613218253833769*^9, 
   3.613218258529906*^9}, {3.6132195428985167`*^9, 3.6132195442344046`*^9}, {
   3.6132538595253353`*^9, 3.613253862887562*^9}, {3.6132538958073597`*^9, 
   3.613253932909927*^9}, {3.613263592788784*^9, 3.6132636071432886`*^9}, {
   3.613270534281849*^9, 3.613270552700043*^9}, {3.6132706392523527`*^9, 
   3.613270759634531*^9}, 3.6132707946016855`*^9, {3.6132726329837885`*^9, 
   3.613272663225811*^9}, {3.6132726939451523`*^9, 3.6132727202195497`*^9}, {
   3.6132727831822414`*^9, 3.613272811984312*^9}, {3.6132730416924143`*^9, 
   3.6132730676616106`*^9}, {3.613273108274502*^9, 3.613273120252433*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aa", "=", "2500."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", "20"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sol", ",", 
     RowBox[{"{", "points", "}"}]}], "}"}], "=", 
   RowBox[{"Reap", "[", 
    RowBox[{"NMinimize", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Hold", "[", 
         RowBox[{"t", "=", 
          RowBox[{"g", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], ",", 
              RowBox[{"x", "[", "2", "]"}], ",", 
              RowBox[{"x", "[", "3", "]"}], ",", 
              RowBox[{"x", "[", "4", "]"}], ",", 
              RowBox[{"x", "[", "5", "]"}], ",", 
              RowBox[{"x", "[", "6", "]"}], ",", 
              RowBox[{"x", "[", "7", "]"}], ",", 
              RowBox[{"x", "[", "8", "]"}], ",", 
              RowBox[{"x", "[", "9", "]"}], ",", 
              RowBox[{"x", "[", "10", "]"}], ",", 
              RowBox[{"x", "[", "11", "]"}], ",", 
              RowBox[{"x", "[", "12", "]"}], ",", 
              RowBox[{"x", "[", "13", "]"}], ",", 
              RowBox[{"x", "[", "14", "]"}], ",", 
              RowBox[{"x", "[", "15", "]"}], ",", 
              RowBox[{"x", "[", "16", "]"}], ",", 
              RowBox[{"x", "[", "17", "]"}], ",", 
              RowBox[{"x", "[", "18", "]"}], ",", 
              RowBox[{"x", "[", "19", "]"}], ",", 
              RowBox[{"x", "[", "20", "]"}]}], "}"}], ",", "aa", ",", "bb"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"And", "@@", 
          RowBox[{"Thread", "@", 
           RowBox[{"LessEqual", "[", 
            RowBox[{"3", ",", "vars", ",", "25"}], "]"}]}]}], "&&", 
         RowBox[{"vars", "\[Element]", "Integers"}]}]}], "}"}], ",", "vars", 
      ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<SimulatedAnnealing\>\"", ",", 
         RowBox[{"\"\<PerturbationScale\>\"", "\[Rule]", "2"}], ",", 
         RowBox[{"\"\<SearchPoints\>\"", "\[Rule]", "100000"}]}], "}"}]}], 
      ",", 
      RowBox[{"EvaluationMonitor", "\[RuleDelayed]", 
       RowBox[{"Sow", "[", 
        RowBox[{"{", 
         RowBox[{"Join", "[", 
          RowBox[{"vars", ",", 
           RowBox[{"{", "t", "}"}]}], "]"}], "}"}], "]"}]}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"root", "<>", "\"\<TI\>\"", "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "aa", "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "bb", "]"}], "<>", "\"\<.xls\>\""}], ",", 
    RowBox[{"DeleteDuplicates", "[", "points", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.612151395967471*^9, 3.6121513959754753`*^9}, {
   3.6121514396665497`*^9, 3.6121514747929244`*^9}, {3.612151531150429*^9, 
   3.6121515939556665`*^9}, {3.6121516487060995`*^9, 
   3.6121517303635283`*^9}, {3.6121519920366282`*^9, 3.612151993723751*^9}, {
   3.6121520489474993`*^9, 3.612152097919014*^9}, {3.6121522070226145`*^9, 
   3.6121522209638968`*^9}, {3.6121522633561*^9, 3.6121523005760384`*^9}, {
   3.6121525334704337`*^9, 3.6121525677792835`*^9}, {3.6121526284435406`*^9, 
   3.612152631594634*^9}, {3.612152678283947*^9, 3.6121526820834775`*^9}, {
   3.612152742270525*^9, 3.6121528674848475`*^9}, {3.6121533066852036`*^9, 
   3.6121533703315554`*^9}, {3.612154093949224*^9, 3.612154109387463*^9}, {
   3.6121541717185793`*^9, 3.6121541741249466`*^9}, {3.612177977327383*^9, 
   3.6121780093005943`*^9}, {3.6121780904714456`*^9, 3.612178098123522*^9}, 
   3.612178793628908*^9, {3.61217933051195*^9, 3.6121793320899963`*^9}, {
   3.6121910514183965`*^9, 3.6121910568119745`*^9}, {3.612191815963853*^9, 
   3.6121919125819426`*^9}, {3.6121919848698983`*^9, 
   3.6121919868542175`*^9}, {3.6121927306586456`*^9, 
   3.6121927322462025`*^9}, {3.612192782470521*^9, 3.6121928081205378`*^9}, {
   3.6121930944373407`*^9, 3.612193094527402*^9}, {3.612193197076432*^9, 
   3.612193238709051*^9}}]
},
WindowSize->{1350, 631},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 20735, 467, 592, "Input"],
Cell[CellGroupData[{
Cell[21317, 491, 17340, 440, 932, "Input"],
Cell[CellGroupData[{
Cell[38682, 935, 1816, 25, 23, "Print"],
Cell[40501, 962, 1818, 25, 23, "Print"],
Cell[42322, 989, 1818, 25, 23, "Print"],
Cell[44143, 1016, 1818, 25, 23, "Print"],
Cell[45964, 1043, 1818, 25, 23, "Print"],
Cell[47785, 1070, 1816, 25, 23, "Print"],
Cell[49604, 1097, 1817, 25, 23, "Print"],
Cell[51424, 1124, 1818, 25, 23, "Print"],
Cell[53245, 1151, 1820, 25, 23, "Print"],
Cell[55068, 1178, 1819, 25, 23, "Print"]
}, Open  ]],
Cell[56902, 1206, 3462, 66, 72, "Output"],
Cell[60367, 1274, 3400, 64, 72, "Output"]
}, Open  ]],
Cell[63782, 1341, 25643, 536, 772, "Input"],
Cell[89428, 1879, 4226, 92, 212, "Input"]
}
]
*)

(* End of internal cache information *)
